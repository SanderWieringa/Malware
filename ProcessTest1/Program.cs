using System;
using System.Collections.Generic;
using System.Diagnostics;

namespace ProcessTest1
{
    class Program
    {
        static void Main(string[] args)
        {
            bool isVm = IsVirtualMachinePresentProcesses();

            Console.WriteLine("======================================================================================");
            if (isVm)
            {
                Console.WriteLine("Host is a virtual machine");
            }
            else
            {
                Console.WriteLine("Host is not a virtual machine");
            }
            
        }

        public static bool IsVirtualMachinePresentProcesses()
        {
            var runningProcesses = Process.GetProcesses();
            var vmProcesses = new List<string>
            {
                "vmware-wmx",
                "VboxService",
                "VboxTray",
                "vm3dservice",
                "VMwareService",
                "VMwareTray",
                "VMwareUser"
            };

            foreach (Process process in runningProcesses)
            {
                Console.WriteLine(process.ProcessName);
                if (!vmProcesses.Contains(process.ProcessName)) continue;
                return true;
            }

            return false;
        }
    }
}
